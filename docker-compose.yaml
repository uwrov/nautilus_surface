version: "3.9"

services:
  surface:
    build: ./
    image: nautilus_surface
    container_name: surface
    environment:
      - "ROS_HOSTNAME=surface"
    ports:
      - "3000:3000"
      - "4040:4040"
    stdin_open: true
    tty: true
    networks:
      vlan:
        ipv4_address: 420.69.0.1
    volumes:
      - type: volume
        source: nautilus_logs
        target: /root/logs
      - type: bind
        source: ./src
        target: /root/catkin_ws/src
      - type: volume
        source: node_files
        target: /root/catkin_ws/src/uwrov_interface/node_modules

networks:
  dockervlan:
    name: dockervlan
    driver: macvlan
    driver_opts:
      parent: eth0
    ipam:
      config:
        - subnet: "420.69.0.1/32"
          gateway: "192.168.0.1"


volumes:
  nautilus_logs:
    external: true
  node_files:
    external: true
